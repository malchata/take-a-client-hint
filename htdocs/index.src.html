<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noindex, nofollow, nocache">
    <title>Take a (Client) Hint!</title>
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/takeahint.css">
    <link rel="stylesheet" href="lib/css/zenburn.css">
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <!-- [0.0] - Intro -->
        <section>
          <!-- [0.1] - Title Card -->
          <section data-state="centered">
            <h1 class="uppercase">Take a</h1>
            <h3>(client)</h3>
            <h1 class="uppercase">Hint</h1>
            <h5>Jeremy Wagner - <a href="https://twitter.com/malchata" rel="noopener">@malchata</a> - <a href="https://jeremy.codes" rel="noopener">jeremy.codes</a></h5>
          </section>
          <!-- [0.2] - Hello! -->
          <section data-state="centered">
            <div class="flex-container">
              <div>
                <h1>Hi!</h1>
                <h3>I'm Jeremy!</h3>
              </div>
              <picture>
                <source srcset="img/me-1x.webp 1x, img/me-2x.webp 2x" type="image/webp">
                <img src="img/me-1x.png" srcset="img/me-1x.png 1x, img/me-2x.png 2x" alt="A cartoon line art drawing of Jeremy Wagner." width="394" height="620">
              </picture>
            </div>
          </section>
        </section>
        <!-- [1.0] - Client Hints Intro -->
        <section>
          <!-- [1.1] - What are Client Hints? -->
          <section data-state="centered">
            <h3>What are</h3>
            <h1 class="uppercase">client hints?</h1>
          </section>
          <!-- [1.2] - The Clueless Browser -->
          <section data-state="centered">
            <picture>
              <source srcset="img/clueless-browser-1x.webp 1x, img/clueless-browser-2x.webp 2x" type="image/webp">
              <img src="img/clueless-browser-1x.png" srcset="img/clueless-browser-1x.png 1x, img/clueless-browser-2x.png 2x" alt="A cartoon drawing of a browser with a question mark hovering over it.">
            </picture>
          </section>
          <!-- [1.3] - The Clueless Server -->
          <section data-state="centered">
            <picture>
              <source srcset="img/clueless-server-1x.webp 1x, img/clueless-server-2x.webp 2x" type="image/webp">
              <img src="img/clueless-server-1x.png" srcset="img/clueless-server-1x.png 1x, img/clueless-server-2x.png 2x" alt="A cartoon drawing of a web server with a question mark hovering over it.">
            </picture>
          </section>
          <!-- [1.4] - The Clueless Device -->
          <section data-state="centered">
            <picture>
              <source srcset="img/sad-device-1x.webp 1x, img/sad-device-2x.webp 2x" type="image/webp">
              <img src="img/sad-device-1x.png" srcset="img/sad-device-1x.png 1x, img/sad-device-2x.png 2x" alt="A cartoon drawing of a mobile device with a sad face on the screen.">
            </picture>
          </section>
          <!-- [1.5] - Content Negotiation -->
          <section data-state="centered">
            <h1 class="uppercase accent">
              Content<br>
              negotiation
            </h1>
          </section>
          <!-- [1.6] - The HTTP Accept Header -->
          <section data-state="centered">
            <h2>The HTTP</h2>
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Accept</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h2>header</h2>
          </section>
          <!-- [1.7] - A Typical <picture> Example -->
          <section>
            <pre><code class="html">&lt;!-- Load a WebP if we can (but fall back if we can't) --&gt;
&lt;picture&gt;
  &lt;source srcset=&quot;whats-up.webp&quot; type=&quot;image/webp&quot;&gt;
  &lt;img src=&quot;whats-up.jpg&quot; alt=&quot;I'm an image!&quot;&gt;
&lt;/picture&gt;
</code></pre>
          </section>
          <!-- [1.8] - Accept Header Example -->
          <section data-state="centered">
            <h4>
              <code>Accept: image/webp,image/*</code>
            </h4>
            <h4 class="fragment">(Contextual, truncated for brevity.)</h4>
          </section>
          <!-- [1.9] - Rewriting the Request -->
          <section data-state="centered">
            <pre><code class="apache">RewriteEngine On
RewriteCond %{HTTP:Accept} image/webp [NC]
RewriteCond %{DOCUMENT_ROOT}/$1.webp -f [NC]
RewriteRule (.+)\.(png|jpe?g|gif)$ $1.webp [T=image/webp,L]</code></pre>
          </section>
          <!-- [1.10] - Rewriting image markup -->
          <section data-state="centered">
            <pre><code class="html">&lt;!-- If WebP is supported, this JPEG request is
     automatically rewritten to a WebP! --&gt;
&lt;img src=&quot;whats-up.jpg&quot; alt=&quot;I'm an image!&quot;&gt;</code></pre>
          </section>
          <!-- [1.11] - Simplicity! -->
          <section data-state="centered">
            <h1 class="accent uppercase">Great!</h1>
            <h4 class="fragment">(If you're into the whole brevity thing.)</h4>
          </section>
          <!-- [1.12] - MIT Article -->
          <section data-background="img/digital-divide.png" data-background-position="center left"></section>
          <!-- [1.13] - MIT Article Quote -->
          <section data-background="img/digital-divide.png" data-background-color="#000000" data-background-position="center left" data-background-opacity=".25">
            <picture>
              <source srcset="img/article-quote-2x.webp 2x, img/article-quote-1x.webp 1x" type="image/webp">
              <img src="img/article-quote-1x.png" srcset="img/article-quote-2x.png 2x, img/article-quote-1x.png 1x" alt="A survey by Pew Research shows that fully one-third of American adults do not subscribe to any Internet access faster than dial-up at their home at a time when many basic tasks—finding job listings, doing homework, obtaining social services, and even performing many jobs—require being online." class="shadow stretch">
            </picture>
          </section>
          <!-- [1.14] - Adaptive Performance -->
          <section data-state="centered">
            <h1 class="uppercase">
              <span class="accent">Adaptive</span><br>
              performance
            </h1>
          </section>
          <!-- [1.15] - The Case Study -->
          <section data-state="centered">
            <h2 class="uppercase">The case study<span class="fragment accent" data-fragment-index="1">*</span></h2>
            <h5 class="fragment accent" data-fragment-index="1">*Totally fictional.</h5>
          </section>
          <!-- [1.16] - A Man of Action -->
          <section data-state="centered">
            <picture>
              <source srcset="img/seagal-zoom.webp" type="image/webp">
              <img src="img/seagal-zoom.gif" alt="A zoom shot into Steven Seagal's face." class="stretch">
            </picture>
          </section>
          <!-- [1.17] - A Man of Leisure -->
          <section data-state="centered">
            <picture>
              <source srcset="img/seagal-carrot.webp" type="image/webp">
              <img src="img/seagal-carrot.gif" alt="An animated GIF of Steven Seagal munching on a carrot." class="stretch">
            </picture>
          </section>
          <!-- [1.18] - Wisconsin! -->
          <section data-state="centered">
            <img src="img/sconnie.svg" alt="An outline of the state of Wisconsin." class="stretch">
          </section>
          <!-- [1.19] - County Broadband Map -->
          <section data-state="centered">
            <picture>
              <source srcset="img/broadband-map-1x.webp 1x, img/broadband-map-2x.webp 2x" type="image/webp">
              <img class="large bordered" src="img/broadband-map-1x.png" srcset="img/broadband-map-1x.png 1x, img/broadband-map-2x.png 2x" alt="A map showing broadband connectivity for Buffalo County, WI in the United States.">
            </picture>
          </section>
          <!-- [1.20] - Performance Bridges the Gap -->
          <section data-state="centered">
            <h1 class="accent uppercase">Performance</h1>
            <h2 class="uppercase">bridges the gap</h2>
          </section>
          <!-- [1.21] - Performance Bridges the Gap -->
          <section data-state="centered">
            <h1 class="accent uppercase">Client hints</h1>
            <h2 class="uppercase">go a bit further</h2>
          </section>
        </section>
        <!-- [2.0] - Opting In -->
        <section>
          <!-- [2.1] - Opting In -->
          <section data-state="section-starter">
            <div class="flex-container">
              <div class="sections">
                <h4 class="current">- Opting in</h4>
                <h4>- Device Hints</h4>
                <h4>- Network hints</h4>
                <h4>- Pitfalls</h4>
                <h4>- Wrapping up</h4>
              </div>
              <picture>
                <source srcset="img/opt-in-out-1x.webp 1x, img/opt-in-out-2x.webp 2x" type="image/webp">
                <img class="section-image" src="img/opt-in-out-1x.png" srcset="img/opt-in-out-1x.png 1x, img/opt-in-out-2x.png 2x" alt="A cartoon drawing of two checkboxes with a pencil near them. One says 'opt out', while the other says 'opt in'. The 'opt in' box is checked." width="640" height="398">
              </picture>
            </div>
          </section>
          <!-- [2.2] - Client Hints are Opt-in -->
          <section data-state="centered">
            <h3>Client hints are</h3>
            <h1 class="uppercase accent">Opt-in only!</h1>
          </section>
          <!-- [2.3] - Client Hints Work in Chrome Only! -->
          <section data-state="centered">
            <picture>
              <source srcset="img/chrome-icon-1x.webp 1x, img/chrome-icon-2x.webp 2x" type="image/webp">
              <img src="img/chrome-icon-1x.png" srcset="img/chrome-icon-1x.png 1x, img/chrome-icon-2x.png 2x" alt="A cartoon drawing of the Chrome icon." width="407" height="405">
            </picture>
            <h4 class="uppercase">
              Client hints work in<br>
              <span class="accent">Chrome only!</span>
            </h4>
            <h5 class="fragment">(And derived browsers.)</h5>
          </section>
          <!-- [2.4] - Client Hints Require HTTPS! -->
          <section data-state="centered">
            <picture>
              <source srcset="img/padlock-1x.webp 1x, img/padlock-2x.webp 2x" type="image/webp">
              <img class="medium" src="img/padlock-1x.png" srcset="img/padlock-1x.png 1x, img/padlock-2x.png 2x" alt="A cartoon drawing of a padlock." width="268" height="480">
            </picture>
            <h3>Client hints <span class="accent">require HTTPS!</span></h3>
          </section>
          <!-- [2.5] - Opt in with `Accept-CH` -->
          <section data-state="centered">
            <h2>Opt in with</h2>
            <h3><code>Accept-CH</code></h3>
          </section>
          <!-- [2.6] - Ways to opt in -->
          <section>
            <h3>Example use:</h3>
            <pre><code class="http">Accept-CH: Viewport-Width, DPR</code></pre>
            <div class="fragment">
              <h3>Via HTML:</h3>
              <pre><code class="html">&lt;meta http-equiv=&quot;Accept-CH&quot; content=&quot;Viewport-Width, DPR&quot;&gt;</code></pre>
            </div>
            <div class="fragment">
              <h3>Via PHP:</h3>
              <pre><code class="php">&lt;?php header(&quot;Accept-CH: Viewport-Width, DPR&quot;); ?&gt;</code></pre>
            </div>
          </section>
          <!-- [2.7] - Ways to opt in -->
          <section data-state="centered">
            <h3>Persist hints with</h3>
            <h3><code>Accept-CH-Lifetime</code></h3>
          </section>
          <!-- [2.8] - Ways to opt in -->
          <section>
            <h3>Example use:</h3>
            <pre><code class="http">Accept-CH-Lifetime: 86400</code></pre>
            <div class="fragment">
              <h3>Via HTML:</h3>
              <pre><code class="html">&lt;meta http-equiv=&quot;Accept-CH-Lifetime&quot; content=&quot;86400&quot;&gt;</code></pre>
            </div>
            <div class="fragment">
              <h3>Via PHP:</h3>
              <pre><code class="php">&lt;?php header(&quot;Accept-CH-Lifetime: 86400&quot;); ?&gt;</code></pre>
            </div>
          </section>
        </section>
        <!-- [3.0] - Image Hints -->
        <section>
          <!-- [3.1] - Image Hints -->
          <section data-state="section-starter">
            <div class="flex-container">
              <div class="sections">
                <h4 class="past">- Opting in</h4>
                <h4 class="current">- Device Hints</h4>
                <h4>- Network hints</h4>
                <h4>- Pitfalls</h4>
                <h4>- Wrapping up</h4>
              </div>
              <picture>
                <source srcset="img/image-icon-1x.webp 1x, img/image-icon-2x.webp 2x" type="image/webp">
                <img class="section-image large" src="img/image-icon-1x.png" srcset="img/image-icon-1x.png 1x, img/image-icon-2x.png 2x" alt="A cartoon drawing of an Netscape-style image icon." width="446" height="512">
              </picture>
            </div>
          </section>
          <!-- [3.2] - Responsive images are hard to get right! -->
          <section data-state="centered">
            <h2 class="uppercase accent">Responsive images</h2>
            <h3 class="uppercase">are hard to get right!</h3>
          </section>
          <!-- [3.3] - Verbose Markup -->
          <section data-state="centered">
            <pre class="stretch"><code class="html">&lt;!-- This is pretty complicated! --&gt;
&lt;picture&gt;
  &lt;source sizes=&quot;(min-width: 512px) 90vw,
                 (min-width: 768px) 66.66vw,
                 512px&quot;
          srcset=&quot;/image-crop-256w.webp 256w,
                  /image-crop-512w.webp 512w,
                  /image-crop-768w.webp 768w,
                  /image-crop-1024w.webp 1024w&quot;
          type=&quot;image/webp&quot;&gt;
  &lt;img sizes=&quot;(min-width: 512px) 90vw,
              (min-width: 768px) 66.66vw,
              512px&quot;
       srcset=&quot;/image-crop-256w.jpg 256w,
               /image-crop-512w.jpg 512w,
               /image-crop-768w.jpg 768w,
               /image-crop-1024w.jpg 1024w&quot;
       src=&quot;/image-crop-256w.jpg&quot;
       alt=&quot;I'm an image!&quot;&gt;
&lt;/picture&gt;</code></pre>
          </section>
          <!-- [3.4] - What We Want -->
          <section>
            <pre><code class="html">&lt;!-- Ah, much simpler! --&gt;
&lt;img src=&quot;/image.jpg&quot; alt=&quot;I'm an image!&quot;&gt;</code></pre>
          </section>
          <!-- [3.5] - DPR -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>DPR</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h4 class="fragment">(Device Pixel Ratio.)</h4>
          </section>
          <!-- [3.6] - `sizes` is Required! -->
          <section data-state="centered">
            <h3>
              <code>DPR: 2</code>
            </h3>
          </section>
          <!-- [3.7] - srcset Code -->
          <section data-state="centered">
            <pre><code class="html">&lt;img src=&quot;whats-up-1x.png&quot;
     srcset=&quot;whats-up-1x.png 1x, whats-up-2x.png 2x&quot;
     alt=&quot;I'm an image!&quot;&gt;</code></pre>
          </section>
          <!-- [3.8] - Negotiating DPR on the Back End -->
          <section data-state="centered">
            <pre><code class="html">&lt;!-- Of course, we're just _assuming_ this is available... --&gt;
&lt;?php $dpr = $_SERVER[&quot;HTTP_DPR&quot;]; ?&gt;
&lt;img src=&quot;whats-up-&lt;?php echo($dpr); ?&gt;x.jpg&quot; alt=&quot;I'm an image!&quot;&gt;
</code></pre>
          </section>
          <!-- [3.9] - How Sconnie Timber Does It -->
          <section>
            <pre><code class="html">&lt;!-- This actually points to a PHP script --&gt;
&lt;img src=&quot;/image/dpr:true/contact-img.jpg&quot;&gt;</code></pre>
          </section>
          <!-- [3.10] - Viewport-Width -->
          <section data-state="centered">
            <h3>
              <img src="img/sparkle-1x.png" width="96" height="95" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Viewport-Width</code>
              <img src="img/sparkle-1x.png" width="96" height="95" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h3>
          </section>
          <!-- [3.10] - `sizes` is Required! -->
          <section data-state="centered">
            <h3>
              <code>Viewport-Width: 320</code>
            </h3>
            <h4 class="fragment">(In CSS pixels)</h4>
          </section>
          <!-- [3.11] - Viewport Width Illustration -->
          <section data-state="centered">
            <picture>
              <source srcset="img/viewport-1x.webp 1x, img/viewport-2x.webp 2x" type="image/webp">
              <img class="section-image large" src="img/viewport-1x.png" srcset="img/viewport-1x.png 1x, img/viewport-2x.png 2x" alt="A cartoon drawing of browser viewport diagram." width="446" height="512">
            </picture>
          </section>
          <!-- [3.12] - Uses for Viewport-Width -->
          <section>
            <h3>Uses for <code>Viewport-Width</code>:</h3>
            <ul>
              <li class="fragment">Image selection <span class="fragment">(more on that in a minute).</span></li>
              <li class="fragment">Image omission.</li>
              <li class="fragment">Functionality omission <span class="fragment">(e.g., JavaScript).</span></li>
            </ul>
          </section>
          <!-- [3.13] - Capturing Viewport-Width -->
          <section>
            <pre><code class="html">&lt;?php
$viewportWidth = false;

if (isset($_SERVER[&quot;HTTP_VIEWPORT_WIDTH&quot;])) {
  $viewportWidth = (int)$_SERVER[&quot;HTTP_VIEWPORT_WIDTH&quot;];
}
?&gt;</code></pre>
          </section>
          <!-- [3.14] - Omitting JS with Viewport-Width -->
          <section>
            <pre><code class="html">&lt;body&gt;
  &lt;div class=&quot;big-hero-banner parallax&quot;&gt;&lt;/div&gt;
  &lt;!-- ... --&gt;
  &lt;!-- This is a critical script for all devices --&gt;
  &lt;script src=&quot;/js/main.js&quot;&gt;&lt;/script&gt;
  &lt;?php
  if ($viewportWidth &gt;= 800) {
    // Only load this script for large screens that need it.
    ?&gt;&lt;script src=&quot;/js/parallax.js&quot;&gt;&lt;/script&gt;&lt;?php
  }
  ?&gt;
&lt;/body&gt;</code></pre>
          </section>
          <!-- [3.15] - Omitting Images Not in the Current Layout -->
          <section>
            <pre><code class="html">&lt;body&gt;
  &lt;!-- This image is used on all devices. --&gt;
  &lt;img src=&quot;img/hero.jpg&quot;&gt;
  &lt;!-- This one is only used on large screens. --&gt;
  &lt;?php
  if ($viewportWidth &gt;= 640) {
    &lt;img src=&quot;img/aside.jpg&quot;&gt;
  }
  ?&gt;
&lt;/body&gt;</code></pre>
          </section>
          <!-- [3.16] - Width -->
          <section data-state="centered">
            <h2>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Width</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h2>
            <h5 class="fragment">(Use this for image selection instead.)</h5>
          </section>
          <!-- [3.17] - Width Only Occurs on Image Requests! -->
          <section data-state="centered">
            <h2><code>Width</code></h2>
            <h4>Only occurs on image requests!</h4>
          </section>
          <!-- [3.18] - Width Requires `sizes` on Image Requests! -->
          <section data-state="centered">
            <h2><code>Width</code></h2>
            <h4>requires <code>sizes</code> to be used<br></h4>
          </section>
          <!-- [3.19] - Sample Request -->
          <section>
            <pre><code class="html">&lt;img src=&quot;/image/slider-01.jpg&quot;
     sizes=&quot;(min-width: 620px) 600px,
            94.7916666667vw&quot;&gt;</code></pre>
          </section>
          <!-- [3.20] - Width Example -->
          <section data-state="centered">
            <h2><code>Width: 684</code></h2>
          </section>
          <!-- [3.21] - Intrinsic Size -->
          <section data-state="centered">
            <h2 class="uppercase">Intrinsic size</h2>
            <h4 class="fragment">The size of a resource in physical pixels.</h4>
          </section>
          <!-- [3.22] - Intrinsic Size -->
          <section data-state="centered">
            <h2 class="uppercase">Density Corrected Intrinsic size</h2>
            <h4 class="fragment">The intrinsic size, but multiplied by <code>DPR</code> to correct for pixel density.</h4>
          </section>
          <!-- [3.23] - Width Requires `sizes` on Image Requests! -->
          <section data-state="centered">
            <h2><code>Width</code></h2>
            <h4>Takes care of this for you<span class="accent fragment" data-fragment-index="1">*</span></h4>
            <h5 class="fragment" data-fragment-index="1"><span class="accent">*</span>Where applicable</h5>
          </section>
        </section>
        <!-- [4.0] - Network Hints -->
        <section>
          <!-- [4.1] - Network Hints -->
          <section data-state="section-starter">
            <div class="flex-container">
              <div class="sections">
                <h4 class="past">- Opting in</h4>
                <h4 class="past">- Device Hints</h4>
                <h4 class="current">- Network hints</h4>
                <h4>- Pitfalls</h4>
                <h4>- Wrapping up</h4>
              </div>
              <picture>
                <source srcset="img/network-cable-1x.webp 1x, img/network-cable-2x.webp 2x" type="image/webp">
                <img class="section-image larger" src="img/network-cable-1x.png" srcset="img/network-cable-1x.png 1x, img/network-cable-2x.png 2x" alt="A cartoon drawing of a network cable." width="512" height="555">
              </picture>
            </div>
          </section>
          <!-- [4.5] - The RTT Header -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>RTT</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h4 class="fragment">Return Trip Time (in ms).</h4>
          </section>
          <!-- [4.4] - RTT Example -->
          <section data-state="centered">
            <h4>
              <code>RTT: 150</code>
            </h4>
            <h5 class="fragment">Nearest multiple of 25 ms</h5>
          </section>
          <!-- [4.5] - The Downlink Header -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Downlink</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h4 class="fragment">Downstream (in Mbps).</h4>
          </section>
          <!-- [4.4] - RTT Example -->
          <section data-state="centered">
            <h4>
              <code>Downlink: 1.75</code>
            </h4>
            <h5 class="fragment">Nearest multiple of 25 Kbps</h5>
          </section>
          <!-- [4.6] - The Network -->
          <section data-state="centered">
            <p>[PLACEHOLDER: NETWORK TOWER SKETCH]</p>
          </section>
          <!-- [4.7] - The ECT Header -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>ECT</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h4 class="fragment">Effective Connection Type</h4>
          </section>
          <!-- [4.8] - ECT Equivalents -->
          <section data-state="centered">
            <table>
              <thead>
                <tr>
                  <th><code>ECT</code> String</th>
                  <th>Min. RTT (ms)</th>
                  <th>Max Downlink (Kbps)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>slow-2g</code></td>
                  <td class="right"><code>2,000</code></td>
                  <td class="right"><code>50</code></td>
                </tr>
                <tr>
                  <td><code>2g</code></td>
                  <td class="right"><code>1,400</code></td>
                  <td class="right"><code>70</code></td>
                </tr>
                <tr>
                  <td><code>3g</code></td>
                  <td class="right"><code>270</code></td>
                  <td class="right"><code>700</code></td>
                </tr>
                <tr>
                  <td><code>4g</code></td>
                  <td class="right"><code>0</code></td>
                  <td class="right"><code>&infin;</code></td>
                </tr>
              </tbody>
            </table>
          </section>
          <!-- [4.9] - Save-Data -->
          <section data-state="centered">
            <h2>
              <img src="img/sparkle-1x.png" width="96" height="95" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Save-Data</code>
              <img src="img/sparkle-1x.png" width="96" height="95" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h2>
            <h4 class="fragment">&quot;Help me use less data!&quot;</h4>
          </section>
          <!-- [4.10] - These Hints Should be Used Together -->
          <section data-state="centered">
            <h2 class="uppercase">These hints should be used <span class="accent">together!</span></h2>
          </section>
          <!-- [4.11] - An Approach to Network Quality Scoring with Client Hints (Pt. I) -->
          <section data-state="centered">
            <pre><code class="html">&lt;?php
function network_quality() {
  $quality = 1;

  if (isset($_SERVER[&quot;HTTP_SAVE_DATA&quot;]) &&
      $_SERVER[&quot;HTTP_SAVE_DATA&quot;] === &quot;on&quot;) {
    $quality = 0;
    return $quality;
  }

  // ...</code></pre>
          </section>
          <!-- [4.12] - An Approach to Network Quality Scoring with Client Hints (Pt. II) -->
          <section data-state="centered">
            <pre><code class="php">  // ...

  if (isset($_SERVER[&quot;HTTP_RTT&quot;])) {
    $rtt = (int)$_SERVER[&quot;HTTP_RTT&quot;];
  }

  if (isset($_SERVER[&quot;HTTP_DOWNLINK&quot;])) {
    $downlink = (float)$_SERVER[&quot;HTTP_DOWNLINK&quot;];
  }

  if (isset($_SERVER[&quot;HTTP_ECT&quot;])) {
    $ect = $_SERVER[&quot;HTTP_ECT&quot;];
  }

  // ...</code></pre>
          </section>
          <!-- [4.13] - An Approach to Network Quality Scoring with Client Hints (Pt. III) -->
          <section data-state="centered">
            <pre><code class="php">  // ...

  if (isset($rtt) && isset($downlink) && isset($ect)) {
    switch ($ect) {
      case &quot;3g&quot;:
        $quality -= 0.2;

        if (isset($rtt) && $rtt &gt; 835) {
          $quality -= 0.1;
        }

        if (isset($downlink) && $downlink &lt; 0.385) {
          $quality -= .05;
        }
        break;

    // ...</code></pre>
          </section>
          <!-- [4.14] - An Approach to Network Quality Scoring with Client Hints (Pt. IV) -->
          <section data-state="centered">
            <pre><code class="php">    // ...

    case &quot;2g&quot;:
      $quality -= 0.4;

      if (isset($rtt) && $rtt &gt; 1700) {
        $quality -= 0.1;
      }

      if (isset($downlink) && $downlink &lt; 0.06) {
        $quality -= .05;
      }
      break;

    // ...</code></pre>
          </section>
          <!-- [4.15] - An Approach to Network Quality Scoring with Client Hints (Pt. V) -->
          <section data-state="centered">
            <pre><code class="php">    // ...

    case &quot;slow-2g&quot;:
      $quality -= 0.6;

      if (isset($rtt) && $rtt &gt; 2400) {
        $quality -= 0.1;
      }

      if (isset($downlink) && $downlink &lt; 0.033) {
        $quality -= .05;
      }
      break;
    }
  }

  return $quality;
}
?&gt;</code></pre>
          </section>
          <!-- [4.16] - What Can We Do With This? -->
          <section>
            <h2 class="uppercase accent">Yeah, but<span class="fragment">.</span><span class="fragment">.</span><span class="fragment">.</span></h2>
            <h3 class="fragment">What can we do with this?</h3>
            <ul class="fragment">
              <li>Serve lower-density images for slower connections.</li>
              <li class="fragment">Serve still images in lieu of video.</li>
              <li class="fragment">Omit web fonts.</li>
              <li class="fragment">Omit unnecessary JavaScript.</li>
            </ul>
          </section>
          <!-- [4.17] - Example -->
          <section>
            <pre><code class="html">&lt;head&gt;
  &lt;title&gt;Sconnie Timber&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;?php
  // Only show fonts if network quality score is high enough
  if (network_quality() &gt; 0.5) {
    ?&gt;
    &lt;link rel=&quot;stylesheet&quot;
          href="https://fonts.googleapis.com/css?family=Lato:400&quot;
          type=&quot;text/css&quot;&gt;
    &lt;?php
  }
  ?&gt;
  &lt;link rel="stylesheet" href="css/main.css" type="text/css"&gt;
&lt;/head&gt;</code></pre>
          </section>
          <!-- [4.18] - JavaScript Equivalents -->
          <section data-state="centered">
            <h2 class="uppercase">JS equivalents</h2>
            <h5>(in <code>navigator.connection</code>)</h5>
            <table>
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Associated Hint</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>rtt</code></td>
                  <td><code>RTT</code></td>
                </tr>
                <tr>
                  <td><code>downlink</code></td>
                  <td><code>Downlink</code></td>
                </tr>
                <tr>
                  <td><code>effectiveType</code></td>
                  <td><code>ECT</code></td>
                </tr>
                <tr>
                  <td><code>saveData</code></td>
                  <td><code>Save-Data</code></td>
                </tr>
              </tbody>
            </table>
          </section>
          <!-- [4.19] - Service Workers! -->
          <section data-state="centered">
            <picture>
              <source srcset="img/service-worker-1x.webp 1x, img/service-worker-2x.webp 2x" type="image/webp">
              <img class="section-image medium" src="img/service-worker-1x.png" srcset="img/service-worker-1x.png 1x, img/service-worker-2x.png 2x" alt="A cartoon drawing of a gear representing service worker technology." width="640" height="585">
            </picture>
            <h3 class="uppercase">Service Workers</h3>
          </section>
          <!-- [4.20] - Service Worker Example -->
          <section>
            <pre><code class="javascript">self.addEventListener(&quot;fetch&quot;, event => {
  let saveData = false;

  // Let's see about that netinfo API
  if (&quot;connection&quot; in navigator) {
    saveData = navigator.connection.saveData;
  }

  event.respondWith(() => {
    if (/\.woff2?$/i.test(event.request.url) === true &&
        saveData === true) {
      // Aw hell naw
      return new Response(new Blob(), {
        status: 204
      });
    }

    // Okily dokily
    return fetch(event.request);
  });
});</code></pre>
          </section>
          <!-- [4.21] - When Sites Don't Adapt -->
          <section data-state="centered">
            <picture>
              <source srcset="img/sconnie-no-hints-1x.webp 1x, img/sconnie-no-hints-2x.webp 2x" type="image/webp">
              <img class="smallest bordered" src="img/sconnie-no-hints-1x.png" srcset="img/sconnie-no-hints-1x.png 1x, img/sconnie-no-hints-2x.png 2x" alt="The Sconnie Timber site when no client hints are used to modify the response." width="328" height="667">
            </picture>
            <h4>When sites don't adapt.</h4>
          </section>
          <!-- [4.22] - When Sites Do Adapt -->
          <section data-state="centered">
            <picture>
              <source srcset="img/sconnie-hints-1x.webp 1x, img/sconnie-hints-2x.webp 2x" type="image/webp">
              <img class="smallest bordered" src="img/sconnie-hints-1x.png" srcset="img/sconnie-hints-1x.png 1x, img/sconnie-hints-2x.png 2x" alt="The Sconnie Timber site when no client hints are used to modify the response." width="328" height="667">
            </picture>
            <h4>When sites do adapt.</h4>
          </section>
        </section>
        <!-- [5.0] - Pitfalls -->
        <section>
          <!-- [5.1] - Pitfalls -->
          <section data-state="section-starter">
            <div class="flex-container">
              <div class="sections">
                <h4 class="past">- Opting in</h4>
                <h4 class="past">- Device Hints</h4>
                <h4 class="past">- Network hints</h4>
                <h4 class="current">- Pitfalls</h4>
                <h4>- Wrapping up</h4>
              </div>
              <picture>
                <source srcset="img/opt-in-out-1x.webp 1x, img/opt-in-out-2x.webp 2x" type="image/webp">
                <img class="section-image" src="img/opt-in-out-1x.png" srcset="img/opt-in-out-1x.png 1x, img/opt-in-out-2x.png 2x" alt="A cartoon drawing of two checkboxes with a pencil near them. One says 'opt out', while the other says 'opt in'. The 'opt in' box is checked." width="640" height="398">
              </picture>
            </div>
          </section>
          <!-- [5.2] - The Vary Header -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Vary</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h3>It's <code>Vary</code> important!</h3>
          </section>
          <!-- [5.3] - Vary Keys Cache Entries -->
          <section data-state="centered">
            <h1>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
              <code>Vary</code>
              <img src="img/sparkle-1x.png" width="123" height="122" srcset="img/sparkle-2x.png 2x, img/sparkle-1x.png 1x" class="sparkle" alt="A cartoon drawing of a sparkle emoji.">
            </h1>
            <h3>Keys cache entries!</h3>
          </section>
          <!-- [5.4] - Varying a Response by Save-Data -->
          <section>
            <h4>Modifying a response with <code>Save-Data</code>:</h4>
            <pre><code class="html">&lt;?php
if (isset($_SERVER[&quot;HTTP_SAVE_DATA&quot;]) === false) {
  // Show this image if the user has data saver off.
  ?&gt;&lt;img src=&quot;some-image.jpg&quot;&gt;&lt;?php
}
?&gt;</code></pre>
            <h4>URI: <code>/contact-us</code></h4>
          </section>
          <!-- [5.5] - Setting Vary -->
          <section>
            <h3>Setting <code>Vary</code>:</h3>
            <pre><code class="apache">&lt;FilesMatch &quot;\.(html|php)$&quot;&gt;
  Header set Vary &quot;Accept-Encoding, Save-Data&quot;
&lt;/FilesMatch&gt;</code></pre>
          </section>
          <!-- [5.6] - Only Set Hints You'll Use! -->
          <section data-state="centered">
            <h2 class="uppercase">Only set hints you'll use!</h2>
          </section>
          <!-- [5.7] - Fingerprinting -->
          <section data-state="centered">
            <picture>
              <source srcset="img/fingerprint-1x.webp 1x, img/fingerprint-2x.webp 2x" type="image/webp">
              <img class="small" src="img/fingerprint-1x.png" srcset="img/fingerprint-1x.png 1x, img/fingerprint-2x.png 2x" alt="A cartoon drawing of a fingerprint." width="430" height="640">
            </picture>
            <h2 class="uppercase">Fingerprinting</h2>
          </section>
          <!-- [5.8] - Reminder: Client Hints Work in Chrome Only! -->
          <section data-state="centered">
            <picture>
              <source srcset="img/chrome-icon-1x.webp 1x, img/chrome-icon-2x.webp 2x" type="image/webp">
              <img src="img/chrome-icon-1x.png" srcset="img/chrome-icon-1x.png 1x, img/chrome-icon-2x.png 2x" alt="A cartoon drawing of the Chrome icon." width="407" height="405">
            </picture>
            <h4 class="uppercase">
              Client hints work in<br>
              <span class="accent">Chrome only!</span>
            </h4>
            <h5 class="fragment">(And derived browsers.)</h5>
          </section>
        </section>
        <!-- [6.0] - Pitfalls -->
        <section>
          <!-- [6.1] - Pitfalls -->
          <section data-state="section-starter">
            <div class="flex-container">
              <div class="sections">
                <h4 class="past">- Opting in</h4>
                <h4 class="past">- Device Hints</h4>
                <h4 class="past">- Network hints</h4>
                <h4 class="past">- Pitfalls</h4>
                <h4 class="current">- Wrapping up</h4>
              </div>
              <picture>
                <source srcset="img/opt-in-out-1x.webp 1x, img/opt-in-out-2x.webp 2x" type="image/webp">
                <img class="section-image" src="img/opt-in-out-1x.png" srcset="img/opt-in-out-1x.png 1x, img/opt-in-out-2x.png 2x" alt="A cartoon drawing of two checkboxes with a pencil near them. One says 'opt out', while the other says 'opt in'. The 'opt in' box is checked." width="640" height="398">
              </picture>
            </div>
          </section>
        </section>
      </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>
      Reveal.initialize({
        history: true,
        controls: false,
        progress: false,
        transition: "none",
        viewDistance: 2,
        help: false,
        dependencies: [{
          src: "plugin/notes/notes.js",
          async: true
        },
        {
          src: "plugin/highlight/highlight.js",
          async: true,
          callback: function() {
            hljs.initHighlightingOnLoad();
          }
        }]
      });
    </script>
  </body>
</html>
